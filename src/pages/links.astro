---
import { getEntry, render } from "astro:content";
import Markdown from "@components/misc/Markdown.astro";
import MainGridLayout from "../layouts/MainGridLayout.astro";

const friends = [
  {
    name: "2hi5hu",
    desc: "我永远的神",
    avatar: "/2hi5hu_avatar.jpg",
    link: "https://2hi5hu.cn"
  },
  {
    name: "heart22",
    desc: "PWN大手子",
    avatar: "/heart22_avatar.jpg",
    link: "https://heart22.top"
  },
  {
    name: "xrntkk",
    desc: "WEB大手子",
    avatar: "/xrntkk_avatar.jpg",
    link: "https://blog.xrntkk.top/"
  }, 
];

const linksPost = await getEntry("spec", "links");
if (!linksPost) throw new Error("links.md not found");
const { Content } = await render(linksPost);
---

<MainGridLayout title="友情链接" description="">
    <div class="flex w-full rounded-[var(--radius-large)] overflow-hidden relative min-h-32">
        <div class="card-base z-10 px-9 py-6 relative w-full">
            
            <Markdown class="mt-2">
                <Content />
            </Markdown>

            <div class="my-links-grid mt-8">
                {friends.map((friend) => (
                    <a href={friend.link} target="_blank" rel="noopener noreferrer" 
                       class="friend-card group">
                        
                        <div class="friend-avatar-container">
                             <img src={friend.avatar} alt={friend.name} class="friend-avatar" />
                        </div>
                        
                        <div class="ml-4 flex-1 min-w-0">
                            <div class="friend-name truncate">
                                {friend.name}
                            </div>
                            <div class="friend-desc mt-1 truncate leading-tight">
                                {friend.desc}
                            </div>
                        </div>
                    </a>
                ))}
            </div>

            <div class="mt-12 pt-6 border-t border-dashed border-black/5 dark:border-white/5 text-[12px] opacity-30 text-center">
                
            </div>
        </div>
    </div>
</MainGridLayout>

<style>
    /* ========================================= */
    /* 布局与基础样式               */
    /* ========================================= */

    /* 手机端一列 */
    .my-links-grid {
        display: grid;
        grid-template-columns: 1fr; 
        gap: 1rem;
    }

    /* 电脑端强制两列 */
    @media (min-width: 600px) {
        .my-links-grid {
            grid-template-columns: 1fr 1fr !important;
        }
    }

    /* 卡片基础样式 */
    .friend-card {
        display: flex;
        align-items: center;
        padding: 0.75rem;
        border-radius: 1rem;
        transition: all 0.3s ease;
        /* 浅色模式默认背景和边框 */
        background-color: white;
        border: 1px solid rgba(0,0,0,0.05);
        box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
    }

    /* ========================================= */
    /* 字体颜色控制 (关键)           */
    /* ========================================= */

    /* --- 1. 名字样式 --- */
    .friend-name {
        font-weight: 700;
        font-size: 1rem;
        color: rgba(0, 0, 0, 0.8); /* 浅色模式：黑色 */
        transition: color 0.3s;
    }
    
    /* 深色模式：强制变白 */
    :global(.dark) .friend-name {
        color: #ffffff !important;
    }

    /* 悬停时：变成主题色 */
    .friend-card:hover .friend-name {
        color: var(--primary) !important;
    }

    /* --- 2. 描述样式 --- */
    .friend-desc {
        font-size: 0.75rem;
        color: rgba(0, 0, 0, 0.4); /* 浅色模式：灰色 */
    }

    /* 深色模式：强制变亮灰 */
    :global(.dark) .friend-desc {
        color: rgba(255, 255, 255, 0.7) !important;
    }

    /* ========================================= */
    /* 深色模式背景控制             */
    /* ========================================= */

    :global(.dark) .friend-card {
        /* 背景变深蓝灰 */
        background-color: #1e1e20; 
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    }

    :global(.dark) .friend-card:hover {
        background-color: #27272a; 
        border-color: var(--primary); 
        transform: translateY(-3px);
    }

    /* 浅色模式悬停 */
    .friend-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        border-color: var(--primary);
    }

    .friend-avatar-container {
        width: 3.5rem;
        height: 3.5rem;
        flex-shrink: 0;
        overflow: hidden;
        border-radius: 9999px;
    }

    .friend-avatar {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>